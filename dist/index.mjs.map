{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import {launch, PDFOptions} from \"puppeteer\";\nimport { Response } from \"express\";\n\nexport interface PdfOptions {\n    res: Response;\n    content?: string;\n    url?: string;\n    filename?: string;\n    pdfOptions?: PDFOptions;\n    download?: boolean;\n    save?: boolean;\n  }\nexport async function generatePdf (options: PdfOptions){\n    const { res, content, url, filename = \"test\", pdfOptions, download, save } = options;\ntry {\n        const browser = await launch({headless:\"new\"});\n        const Options:PDFOptions = {\n            path: save ? `${filename}.pdf` : undefined,\n            format: pdfOptions?.format? pdfOptions.format : \"A4\",\n            ...pdfOptions\n          }\n          \n          if(url && content) throw new Error(\"You can only pass one of url or content\");\n    \n        browser.newPage().then(async (page) => {\n          if(content) await page.setContent(content);\n          if(url)await page.goto(url, {waitUntil: 'networkidle0'});\n          await page.pdf(Options).then((buffer) => {\n            res.setHeader(\"Content-Type\", \"application/pdf\");\n            if(download){\n                res.setHeader(\n                    \"Content-Disposition\",\n                    `attachment; filename=${filename}.pdf`\n                  );\n            };\n            res.send(buffer);\n            res.end();\n          }\n          );\n          await browser.close();\n        });\n} catch (error) {\n    console.error(error);\n    res.status(500).send('Error generating PDF');\n}\n  }"],"mappings":"AAAA,OAAQ,UAAAA,MAAyB,YAYjC,eAAsBC,EAAaC,EAAoB,CACnD,GAAM,CAAE,IAAAC,EAAK,QAAAC,EAAS,IAAAC,EAAK,SAAAC,EAAW,OAAQ,WAAAC,EAAY,SAAAC,EAAU,KAAAC,CAAK,EAAIP,EACjF,GAAI,CACI,IAAMQ,EAAU,MAAMV,EAAO,CAAC,SAAS,KAAK,CAAC,EACvCW,EAAqB,CACvB,KAAMF,EAAO,GAAGH,CAAQ,OAAS,OACjC,OAAQC,GAAY,OAAQA,EAAW,OAAS,KAChD,GAAGA,CACL,EAEA,GAAGF,GAAOD,EAAS,MAAM,IAAI,MAAM,yCAAyC,EAE9EM,EAAQ,QAAQ,EAAE,KAAK,MAAOE,GAAS,CAClCR,GAAS,MAAMQ,EAAK,WAAWR,CAAO,EACtCC,GAAI,MAAMO,EAAK,KAAKP,EAAK,CAAC,UAAW,cAAc,CAAC,EACvD,MAAMO,EAAK,IAAID,CAAO,EAAE,KAAME,GAAW,CACvCV,EAAI,UAAU,eAAgB,iBAAiB,EAC5CK,GACCL,EAAI,UACA,sBACA,wBAAwBG,CAAQ,MAClC,EAENH,EAAI,KAAKU,CAAM,EACfV,EAAI,IAAI,CACV,CACA,EACA,MAAMO,EAAQ,MAAM,CACtB,CAAC,CACT,OAASI,EAAO,CACZ,QAAQ,MAAMA,CAAK,EACnBX,EAAI,OAAO,GAAG,EAAE,KAAK,sBAAsB,CAC/C,CACE","names":["launch","generatePdf","options","res","content","url","filename","pdfOptions","download","save","browser","Options","page","buffer","error"]}